window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();var AEROTWIST=AEROTWIST||{};AEROTWIST.Bootstrap=function(){window.addEventListener("load",function(){for(var e=document.querySelectorAll(".carousel"),t=0;e.length>t;t++)new AEROTWIST.Carousel(e[t])},!1)}();var AEROTWIST=AEROTWIST||{};AEROTWIST.Easing={Linear:function(e){return Math.min(Math.max(0,e),1)}};var TWEEN={Easing:{Quintic:{EaseIn:function(e){return e*e*e*e*e},EaseOut:function(e){return(e-=1)*e*e*e*e+1},EaseInOut:function(e){return 1>(e*=2)?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}}}};AEROTWIST.Carousel=function(e){function t(){if(C.clientWidth&&C.clientHeight)if(n(),L){var e=B((Date.now()-q)/$);if(AEROTWIST.CarouselAnimations[D]({percentage:e,duration:$,onScreenBufferCtx:h,offScreenBufferCtx:R,offScreenBuffer:I,viewportChanged:x,width:W,height:b,fromImage:v[w],toImage:v[O]}),e>=1){var a=v[w];L=!1,w=O,_=Date.now(),P=a.getAttribute("data-time")||d,p.setAttribute("href",v[w].getAttribute("data-link")||"/")}}else S.length&&S[S.length-1]!=w&&(P=0);x=!1,requestAnimFrame(t)}function n(){var e=Date.now()-_,t=v[w];!L&&e>P&&(S.length||i(1),O=S[S.length-1],S.length=0,D=t.getAttribute("data-transition")||T,$=t.getAttribute("data-duration")||A,q=Date.now(),L=!0)}function a(){C.clientWidth&&C.clientHeight&&(W=E.width=I.width=C.clientWidth,b=E.height=I.height=C.clientHeight,x=!0,l())}function i(e){var t=w;S.length?t=S[S.length-1]:L&&(t=O);var n=(t+v.length+e)%v.length;S.push(n)}function r(){v[0].style.visibility="hidden",C.appendChild(E)}function s(e){i(1),P=0,e.preventDefault()}function o(e){i(-1),P=0,e.preventDefault()}function c(){f.setAttribute("class","next active"),f.setAttribute("href","#"),f.addEventListener("click",s,!1),f.addEventListener("touchend",s,!1),g.setAttribute("class","prev active"),g.setAttribute("href","#"),g.addEventListener("click",o,!1),g.addEventListener("touchend",o,!1),C.appendChild(g),C.appendChild(f)}function l(){var e=v[w];h.drawImage(e,0,0,W,b)}function u(){1!==v.length&&(window.addEventListener("resize",a,!1),a(),r(),c(),t())}var d=4e3,T="crossFade",A=700,m=AEROTWIST.Easing.Linear,E=document.createElement("canvas"),I=document.createElement("canvas"),f=document.createElement("a"),g=document.createElement("a"),h=E.getContext("2d"),R=I.getContext("2d"),S=[],C=e,p=C.querySelector("#storylink"),v=C.querySelectorAll("img"),w=0,O=0,W=0,b=0,x=!1,L=!1,_=Date.now(),P=v[0].getAttribute("data-time")||d,D=0,$=0,q=0,B=window[v[0].getAttribute("easing")]||m;u()},AEROTWIST.CarouselAnimations={constants:{STRIPES:10,STRIPE_HORIZONTAL:1,STRIPE_VERTICAL:2,STRIPE_DIRECTION:1,STRIPE_DELAY:30},crossFade:function(e){var t=e.percentage,n=e.onScreenBufferCtx,a=e.width,i=e.height,r=e.fromImage,s=e.toImage;n.save(),n.globalAlpha=1-t,n.drawImage(r,0,0,a,i),n.globalAlpha=t,n.drawImage(s,0,0,a,i),n.restore()},dipToBlack:function(e){var t=e.percentage,n=e.onScreenBufferCtx,a=e.offScreenBufferCtx,i=e.offScreenBuffer,r=e.width,s=e.height,o=e.fromImage,c=e.toImage,l=0;t*=2,n.clearRect(0,0,r,s),0===t&&(a.save(),a.clearRect(0,0,r,s),a.fillStyle="#000",a.fillRect(0,0,r,s),a.globalCompositeOperation="destination-in",a.drawImage(c,0,0,r,s),a.restore()),n.save(),n.drawImage(i,0,0,r,s),1>t?(l=1-t,n.globalAlpha=TWEEN.Easing.Quintic.EaseIn(l),n.drawImage(o,0,0,r,s)):(l=t-1,n.globalAlpha=TWEEN.Easing.Quintic.EaseOut(l),n.drawImage(c,0,0,r,s)),n.restore()},stripeHorizontal:function(e){e.stripeDirection=AEROTWIST.CarouselAnimations.constants.STRIPE_HORIZONTAL,AEROTWIST.CarouselAnimations._stripes(e)},stripeHorizontalAlternated:function(e){e.stripeDirection=AEROTWIST.CarouselAnimations.constants.STRIPE_HORIZONTAL,e.stripeAlternatedX=!0,AEROTWIST.CarouselAnimations._stripes(e)},stripeVertical:function(e){e.stripeDirection=AEROTWIST.CarouselAnimations.constants.STRIPE_VERTICAL,AEROTWIST.CarouselAnimations._stripes(e)},stripeVerticalAlternated:function(e){e.stripeDirection=AEROTWIST.CarouselAnimations.constants.STRIPE_VERTICAL,e.stripeAlternatedY=!0,AEROTWIST.CarouselAnimations._stripes(e)},_stripes:function(e){var t=e.percentage,n=e.duration,a=t*n,i=e.onScreenBufferCtx,r=e.offScreenBufferCtx,s=e.offScreenBuffer,o=e.width,c=e.height,l=e.fromImage,u=e.toImage,d=e.stripeAlternatedX||!1,T=e.stripeAlternatedY||!1,A=l.getAttribute("data-stripecount")||AEROTWIST.CarouselAnimations.constants.STRIPES,m=e.stripeDirection||AEROTWIST.CarouselAnimations.constants.STRIPE_DIRECTION,E=l.getAttribute("data-stripedelay")||AEROTWIST.CarouselAnimations.constants.STRIPE_DELAY,I=n-(A-1)*E,f=e.easingFunction||TWEEN.Easing.Quintic.EaseInOut,g=b*E,h=a-g,R=Math.min(1,h/I),S=0,C=0,p=0,v=0,w=0,O=0,W=0;m===AEROTWIST.CarouselAnimations.constants.STRIPE_VERTICAL?(p=Math.ceil(o/A),v=c):(p=o,v=Math.ceil(c/A)),(0===t||e.viewportChanged)&&(r.clearRect(0,0,o,c),r.drawImage(u,0,0,o,c)),i.clearRect(0,0,o,c),i.drawImage(l,0,0,o,c);for(var b=0;A>b;b++)g=b*E,h=a-g,R=Math.min(1,h/I),w=f(R),m===AEROTWIST.CarouselAnimations.constants.STRIPE_VERTICAL?O=b*p:W=b*v,g>a||0>=w||O>o||W>c||(S=w*p,C=w*v,m===AEROTWIST.CarouselAnimations.constants.STRIPE_VERTICAL?S=Math.min(p,o-O):C=Math.min(v,c-W),1>p||1>v||1>S||1>C||i.drawImage(s,d&&0===b%2?o-S:O,T&&0===b%2?c-C:W,S,C,d&&b%2?o-S:O,T&&b%2?c-C:W,S,C))}};var AEROTWIST=AEROTWIST||{};AEROTWIST.GUI=function(){var e=0,t=$("body.home #news-container ol > li > span");t.bind("selectstart",!1).bind("click touchstart",function(t){var n=$(this),a=parseInt(n.data("index"),10)-1;return a!==e&&($("#news-container ul li").removeClass("next").removeClass("prev").removeClass("transitionable"),$("#news-container ul li:gt("+a+")").addClass("next"),$("#news-container ul li:lt("+a+")").addClass("prev"),$("#news-container ul li:eq("+a+")").addClass("transitionable"),$("#news-container ul li:eq("+e+")").addClass("transitionable"),$("#news-container ol li").removeClass("active"),n.closest("li").addClass("active"),e=a),t.stopImmediatePropagation(),!1}),$("header #see-menu").bind("click",function(){var e=$("nav ul"),t=$(this);return e.toggleClass("active"),e.is(":visible")?(t.addClass("menu"),t.text("Hide Menu")):(t.removeClass("menu"),t.text("See Menu")),!1})}();var AEROTWIST=AEROTWIST||{};AEROTWIST.ShareSubscribe=function(){var e=$("#share-subscribe-toggle"),t=e.closest(".share-subscribe");e.click(function(){return t.toggleClass("expanded"),!1}),t.bind("click touchstart",function(e){e.stopPropagation()}),$(document).bind("click touchstart",function(){t.hasClass("expanded")&&t.removeClass("expanded")})}();